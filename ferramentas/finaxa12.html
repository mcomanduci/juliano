<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <!-- üßÆ Calculadora de EBITDA ‚Äì Finaxa.me -->
    <section
      class="finaxa-ebitda-widget"
      role="region"
      aria-labelledby="widgetTitle"
    >
      <style>
        :root {
          --primary: #4fc3f7;
          --primary-dark: #0288d1;
          --bg: #f4f7fb;
          --card: #fff;
          --text: #07203a;
          --muted: #6b7280;
          --glass: rgba(255, 255, 255, 0.05);
        }

        .finaxa-ebitda-widget {
          font-family: "Inter", sans-serif;
          background: var(--bg);
          color: var(--text);
          border-radius: 16px;
          box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
          padding: 24px;
          max-width: 920px;
          margin: 20px auto;
          box-sizing: border-box;
        }

        .finaxa-ebitda-widget * {
          box-sizing: border-box;
        }
        .finaxa-ebitda-widget h1 {
          font-size: 22px;
          margin: 0;
        }
        .finaxa-ebitda-widget p.lead {
          font-size: 14px;
          color: var(--muted);
          margin: 4px 0 0;
        }

        .finaxa-ebitda-top {
          display: flex;
          flex-wrap: wrap;
          align-items: center;
          gap: 12px;
          margin-bottom: 16px;
        }

        .finaxa-logo {
          width: 50px;
          height: 50px;
          border-radius: 12px;
          background: linear-gradient(
            135deg,
            var(--primary),
            var(--primary-dark)
          );
          display: flex;
          justify-content: center;
          align-items: center;
          color: #fff;
          font-weight: 700;
          font-size: 18px;
        }

        .finaxa-grid {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 16px;
        }

        .finaxa-card {
          background: var(--card);
          border-radius: 12px;
          padding: 16px;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .finaxa-panel {
          background: var(--glass);
          border-radius: 12px;
          padding: 16px;
        }

        label {
          display: block;
          font-size: 13px;
          margin-bottom: 4px;
          color: var(--muted);
        }

        input[type="number"] {
          width: 100%;
          padding: 10px;
          border-radius: 8px;
          border: 1px solid var(--glass);
          background: transparent;
          font-size: 14px;
          color: var(--text);
        }

        .finaxa-actions {
          display: flex;
          flex-wrap: wrap;
          gap: 8px;
          margin-top: 12px;
        }

        button.finaxa-btn {
          padding: 10px 14px;
          border: none;
          border-radius: 10px;
          font-weight: 600;
          cursor: pointer;
          transition: 0.2s;
        }

        .btn-primary {
          background: linear-gradient(
            90deg,
            var(--primary),
            var(--primary-dark)
          );
          color: #fff;
        }
        .btn-primary:hover {
          opacity: 0.85;
        }
        .btn-ghost {
          background: transparent;
          border: 1px solid var(--glass);
          color: var(--text);
        }
        .btn-ghost:hover {
          background: var(--glass);
        }

        .result-item {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 8px 0;
          border-bottom: 1px dashed rgba(0, 0, 0, 0.05);
        }
        .result-item:last-child {
          border-bottom: 0;
        }
        .big {
          font-size: 20px;
          font-weight: 800;
        }
        .meta {
          font-size: 13px;
          color: var(--muted);
        }

        .chart-wrap {
          margin-top: 12px;
          width: 100%;
          overflow: hidden;
        }
        .chart-wrap canvas {
          width: 100% !important;
          height: auto !important;
        }

        details {
          background: var(--glass);
          padding: 8px;
          border-radius: 8px;
          margin-top: 6px;
        }

        summary {
          cursor: pointer;
          font-weight: 600;
        }

        /* ===== Responsivo ===== */
        @media (max-width: 768px) {
          .finaxa-grid {
            grid-template-columns: 1fr;
          }
          .finaxa-actions {
            flex-direction: column;
          }
          input[type="number"],
          button.finaxa-btn {
            width: 100%;
          }
          .finaxa-ebitda-widget {
            padding: 16px;
          }
        }
      </style>

      <div class="finaxa-ebitda-top">
        <div class="finaxa-logo">EB</div>
        <div>
          <h1 id="widgetTitle">Calculadora de EBITDA</h1>
          <p class="lead">
            Calcule EBITDA, EBIT e margens de forma simples e visual.
          </p>
        </div>
      </div>

      <div class="finaxa-grid">
        <div class="finaxa-card">
          <form id="ebitdaForm" onsubmit="return false;">
            <label for="lucro">Lucro L√≠quido (R$)</label>
            <input id="lucro" type="number" step="0.01" value="200000" />

            <label for="receita">Receita L√≠quida (R$)</label>
            <input
              id="receita"
              type="number"
              step="0.01"
              placeholder="(opcional)"
            />

            <label for="juros">Juros (R$)</label>
            <input id="juros" type="number" step="0.01" value="50000" />

            <label for="impostos">Impostos (R$)</label>
            <input id="impostos" type="number" step="0.01" value="30000" />

            <label for="depre">Deprecia√ß√£o (R$)</label>
            <input id="depre" type="number" step="0.01" value="20000" />

            <label for="amort">Amortiza√ß√£o (R$)</label>
            <input id="amort" type="number" step="0.01" value="10000" />

            <div class="finaxa-actions">
              <button id="calcBtn" class="finaxa-btn btn-primary">
                Calcular
              </button>
              <button id="resetBtn" class="finaxa-btn btn-ghost">Limpar</button>
              <button id="exportXlsxBtn" class="finaxa-btn btn-ghost">
                Exportar .xlsx
              </button>
              <button id="exportCsvBtn" class="finaxa-btn btn-ghost">
                Exportar .csv
              </button>
            </div>
          </form>
        </div>

        <aside class="finaxa-panel">
          <div class="result-item">
            <div class="meta">EBITDA</div>
            <div class="big" id="ebitdaVal">R$ 0,00</div>
          </div>
          <div class="result-item">
            <div class="meta">EBIT</div>
            <div class="big" id="ebitVal">R$ 0,00</div>
          </div>
          <div class="result-item">
            <div class="meta">Margem EBITDA</div>
            <div class="big" id="margemVal">‚Äî</div>
          </div>
          <div class="result-item">
            <div class="meta">Margem EBIT</div>
            <div class="big" id="margemEbitVal">‚Äî</div>
          </div>
          <div class="chart-wrap"><canvas id="compChart"></canvas></div>
        </aside>
      </div>

      <section style="margin-top: 16px">
        <h2>O que esta ferramenta faz</h2>
        <p class="small">
          Soma Lucro L√≠quido + Juros + Impostos + Deprecia√ß√£o + Amortiza√ß√£o para
          calcular EBITDA e margens.
        </p>
        <details>
          <summary>Por que usar EBITDA?</summary>
          <p class="small">
            Permite comparar rentabilidade operacional entre empresas.
          </p>
        </details>
        <details>
          <summary>EBITDA substitui fluxo de caixa?</summary>
          <p class="small">N√£o, mas ajuda a entender desempenho operacional.</p>
        </details>
      </section>

      <script>
        const $ = (id) => document.getElementById(id);
        const fmtBR = (v) =>
          (Number(v) || 0).toLocaleString("pt-BR", {
            style: "currency",
            currency: "BRL",
          });

        async function loadScript(src) {
          return new Promise((res, rej) => {
            const s = document.createElement("script");
            s.src = src;
            s.onload = res;
            s.onerror = rej;
            document.head.appendChild(s);
          });
        }

        function calcular() {
          const lucro = Number($("lucro").value) || 0,
            juros = Number($("juros").value) || 0,
            impostos = Number($("impostos").value) || 0,
            depre = Number($("depre").value) || 0,
            amort = Number($("amort").value) || 0,
            receita = Number($("receita").value) || 0;

          const ebitda = lucro + juros + impostos + depre + amort;
          const ebit = lucro + juros + impostos;
          const margemEbitda = receita ? (ebitda / receita) * 100 : null;
          const margemEbit = receita ? (ebit / receita) * 100 : null;

          $("ebitdaVal").textContent = fmtBR(ebitda);
          $("ebitVal").textContent = fmtBR(ebit);
          $("margemVal").textContent =
            margemEbitda === null ? "‚Äî" : margemEbitda.toFixed(2) + " %";
          $("margemEbitVal").textContent =
            margemEbit === null ? "‚Äî" : margemEbit.toFixed(2) + " %";

          if (window.compChart && window.compChart.data) {
            window.compChart.data.datasets[0].data = [
              lucro,
              juros,
              impostos,
              depre,
              amort,
            ];
            window.compChart.update();
          }

          return {
            lucro,
            juros,
            impostos,
            depre,
            amort,
            receita,
            ebitda,
            ebit,
            margemEbitda,
            margemEbit,
          };
        }

        document.addEventListener("click", async (e) => {
          if (e.target.id === "calcBtn") {
            calcular();
          }
        });

        (async function init() {
          await loadScript("https://cdn.jsdelivr.net/npm/chart.js");
          const ctx = $("compChart").getContext("2d");
          window.compChart = new Chart(ctx, {
            type: "doughnut",
            data: {
              labels: [
                "Lucro L√≠quido",
                "Juros",
                "Impostos",
                "Deprecia√ß√£o",
                "Amortiza√ß√£o",
              ],
              datasets: [
                {
                  data: [200000, 50000, 30000, 20000, 10000],
                  backgroundColor: [
                    "#4fc3f7",
                    "#0288d1",
                    "#81c784",
                    "#ffb74d",
                    "#4db6ac",
                  ],
                },
              ],
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: { legend: { position: "bottom" } },
            },
          });
          calcular();
        })();
      </script>
    </section>
  </body>
</html>
